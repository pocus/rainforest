<h1>Product listing</h1>

<p>
	<%= form_tag products_path, method: :get, authentication: false, id: 'search-form' do %>
  <%= text_field_tag :search, params[:search] %>
  <%= submit_tag "Search" %>
<% end %>
</p>

<p>
	<%= link_to "add new product", new_product_path %>
</p>

<p>
	<%= link_to "add new user", new_user_path %>
</p>

<div id="products">
	<%= render @products %>
</div>


<script type="text/javascript">

	function display_search_results () {
		if (this.readyState === 4){
			console.log(this);
			document.getElementById('products').innerHTML = this.responseText;
		}
	}

	var form = document.getElementById('search-form');

	form.addEventListener('submit', function(event){
		event.preventDefault();
		var searchValue = document.getElementById('search').value;
		var xhr = new XMLHttpRequest();
		xhr.onload = display_search_results;
		xhr.open('GET', '/products/search?search=' + searchValue,true);
		xhr.send();
	});



</script>